JQKF={version:1.0,author:"jq"};JQKF.namespace=function(){var b=arguments,c=null,d,e,f,g;for(d=0;d<b.length;++d){f=b[d].split(".");g=f[0];eval("if(typeof("+g+')=="undefined"){'+g+"={};};c="+g+";");for(e=1;e<f.length;++e){c[f[e]]=c[f[e]]||{};c=c[f[e]]}}};JQKF.namespace("JQKF","JQKF.cls","JQKF.obj","JQKF.util","JQKF.con","JQKF.lang");window.onerror=function(b,c,d){};if(!window.console){window.console={log:function(b){},error:function(){}}};JQKF.util={g:function(b){return document.getElementById(b)},q:function(b){var c=new RegExp("(^|&)"+b+"=([^&]*)(&|$)","i");var d=window.location.search.substr(1).match(c);if(d!=null)return unescape(d[2]);return null},trim:function(b){return b.replace(/(^\s+)|\s+$/g,"")},format:function(b){for(var c=1;c<arguments.length;c++){b=b.replace(new RegExp("\\{"+(c-1)+"\\}","g"),arguments[c])};return b},contains:function(b,c,d){return JQKF.util.contain(b.split(d?d:","),c)},startsWith:function(b,c){return b.substring(0,c.length)==c},endsWith:function(b,c){return b.substring(b.length-c.length,b.length)==c},indexOf:function(b,c,d){var e=b.length;if(d==null){d=0}else if(d<0){d=Math.max(0,e+d)};for(var f=d;f<e;f++)if(b[f]===c)return f;return-1},forEach:function(b,c,d){var e=b.length;for(var f=0;f<e;f++)c.call(d,b[f],f,b)},some:function(b,c,d){var e=b.length;for(var f=0;f<e;f++)if(c.call(d,b[f],f,b)){return true};return false},find:function(b,c,d){var e=b.length;for(var f=0;f<e;f++)if(c.call(d,b[f],f,b)){return b[f]};return null},contain:function(b,c){return JQKF.util.indexOf(b,c)!=-1},dateToString:function(b,c){if(!c)c="yyyy-MM-dd HH:mm:ss";var d=new String();if(typeof(c)=="string"){d=c;d=d.replace(/yyyy|YYYY/,b.getFullYear());d=d.replace(/yy|YY/,b.getFullYear().toString().substr(2,2));d=d.replace(/MM/,b.getMonth()>=9?b.getMonth()+1:"0"+(b.getMonth()+1));d=d.replace(/M/,b.getMonth());d=d.replace(/dd|DD/,b.getDate()>9?b.getDate():"0"+b.getDate());d=d.replace(/d|D/,b.getDate());d=d.replace(/hh|HH/,b.getHours()>9?b.getHours():"0"+b.getHours());d=d.replace(/h|H/,b.getHours());d=d.replace(/mm/,b.getMinutes()>9?b.getMinutes():"0"+b.getMinutes());d=d.replace(/m/,b.getMinutes());d=d.replace(/ss|SS/,b.getSeconds()>9?b.getSeconds():"0"+b.getSeconds());d=d.replace(/s|S/,b.getSeconds())};return d.replace(" 00:00:00","")},convertToDateTime:function(b){var c=b.toString().match(/^(\d{0,4})-(\d{0,2})-(\d{0,2}) (\d{0,2}):(\d{0,2}):(\d{0,2})$/);if(c==null)return null;return new Date(c[1],c[2]-1,c[3],c[4],c[5],c[6])},getCookie:function(b){var c=document.cookie.match(new RegExp("(^| )"+b+"=([^;]*)(;|$)"));if(c!=null)return c[2];else return null},setCookie:function(b,c,d,e,f,h){document.cookie=b+"="+escape(c);},getParam:function(b,c){var d=new RegExp("(^|&)"+c+"=([^&]*)(&|$)","i");var e=b.match(d);if(e!=null)return unescape(e[2]);return null},decodeHTML:function(b){b=b.replace(new RegExp(String.fromCharCode(4),"gm"),"\"");return b},jsonToUrl:function(b){var c=[];for(var d in b){c.push(d+"="+b[d])};return c.join("&")},getFileSize:function(b){var c=new Image();var d=b.value;var e=0;try{c.dynsrc=d}catch(U){return 0};try{e=c.fileSize||0}catch(U){};if(e==0){try{e=b.files[0].fileSize}catch(U){}};return e},getImageWH:function(b,c){var d=new Image();d.onload=c;d.src=b;return d},getFormatFileLengthString:function(b){if(typeof b=="string")b=parseInt(b);if(b>=1073741824){return(b/1073741824).toFixed(2)+"GB"}else if(b>=1048576){return(b/1048576).toFixed(2)+"MB"}else if(b>=1024){return(b/1024).toFixed(2)+"KB"}else return b+"Bytes"},lenOf:function(b){b=b+'a';var c=b.match(/[\x00-\xff]/g).length;return((b.length-c)*2+c-1)}};(function(){var b=JQKF;b.host=window.location.host;var c=navigator.platform.toLowerCase(),d=navigator.userAgent.toLowerCase(),e=navigator.plugins,f,g,getVer,h;getVer=function(i,j){i=(""+i).replace(/_/g,".");j=j||1;i=String(i).split(".");i=i[0]+"."+(i[1]||"0");i=Number(i).toFixed(j);return i};f={getPlatform:function(){return c},name:(window.a!=undefined)?"iPod":(c.match(/mac|win|linux/i)||["unknown"])[0],fullName:c,version:0,iPod:0,iPad:0,iPhone:0,android:0,win:0,linux:0,mac:0,set:function(j,k,l){this.name=j;this.version=k;this[j]=k;if(j=="win"){if(l=="windows nt 4.0")this.fullName="Windows NT 4.0";else if(l=="windows nt 5.0")this.fullName="Windows 2000";else if(l=="windows nt 5.1")this.fullName="Windows XP";else if(l=="windows nt 5.2")this.fullName="Windows 2003";else if(l=="windows nt 6.0")this.fullName="Windows 7";else if(l=="windows nt 6.1")this.fullName="Windows 7";else if(l=="windows nt 6.2")this.fullName="Windows 7";else this.fullName=l}else{this.fullName=l}}};f[f.name]=true;(h=d.match(/windows ([\d.]+)/))?f.set("win",getVer(h[1]),h[0]):(h=d.match(/windows nt ([\d.]+)/))?f.set("win",getVer(h[1]),h[0]):(h=d.match(/linux ([\d.]+)/))?f.set("linux",getVer(h[1]),h[0]):(h=d.match(/mac ([\d.]+)/))?f.set("mac",getVer(h[1]),h[0]):(h=d.match(/ipod ([\d.]+)/))?f.set("iPod",getVer(h[1]),h[0]):(h=d.match(/ipad[\D]*os ([\d_]+)/))?f.set("iPad",getVer(h[1]),h[0]):(h=d.match(/iphone ([\d.]+)/))?f.set("iPhone",getVer(h[1]),h[0]):(h=d.match(/android ([\d.]+)/))?f.set("android",getVer(h[1]),h[0]):0;g={features:{xpath:!!(document.evaluate),air:!!(window.runtime),query:!!(document.querySelector)},getPlugins:function(){return e},plugins:{flash:(function(){var i=0;if(e&&e.length){flash=e["Shockwave Flash"];if(flash&&flash.description){i=getVer(flash.description.match(/\b(\d+)\.\d+\b/)[1],1)||i}}else{var j=13;while(j--){try{new ActiveXObject("ShockwaveFlash.ShockwaveFlash."+j);i=getVer(j);break}catch(o){}}};return i})()},getUserAgent:function(){return d},name:"unknown",fullName:"unknown",version:0,ie:0,firefox:0,chrome:0,opera:0,safari:0,mobileSafari:0,set:function(i,j){this.name=i;this.version=j;this[i]=j;if(i=="ie")this.fullName=i+" "+j;else this.fullName=i}};(h=d.match(/msie ([\d.]+)/))?g.set("ie",getVer(h[1])):(h=d.match(/firefox\/([\d.]+)/))?g.set("firefox",getVer(h[1])):(h=d.match(/chrome\/([\d.]+)/))?g.set("chrome",getVer(h[1])):(h=d.match(/opera.([\d.]+)/))?g.set("opera",getVer(h[1])):(h=d.match(/version\/([\d.]+).*safari/))?g.set("safari",getVer(h[1])):0;(h=d.match(/version\/([\d.]+).*mobile.*safari/))?g.set("mobileSafari",getVer(h[1])):0;if(f.iPad){g.set("mobileSafari","0.0")};b.platform=f;b.browser=g})();JQKF.lang["zh-cn"]={"id":1,list_title:"\u5728\u7ebf\u5ba2\u670d",invite_title:"\u5728\u7ebf\u95ee\u6211",btn_accept:"<span style='padding: 5px 0 0 0px;'>\u5f00\u59cb\u4ea4\u8c08</span>",btn_refuse:"<span style='padding: 5px 0 0 0px;'>\u7a0d\u540e\u518d\u8bf4</span>",invite_words:"\u60a8\u597d\uff0c\u91d1\u6865\u5728\u7ebf\u5ba2\u670d\uff0c\u7aed\u8bda\u4e3a\u60a8\u670d\u52a1\u3002",other_dept:"\u5176\u5b83\u90e8\u95e8",invite_word:"\u60a8\u597d\uff0c{0}\u9080\u8bf7\u60a8\u5bf9\u8bdd\uff01"};JQKF.lang["en-us"]={"id":2,list_title:"Online Ask Me",invite_title:"Online Ask Me",btn_accept:"<span style='padding: 5px 0 0 0px;'>Talk Now</span>",btn_refuse:"<span style='padding: 5px 0 0 0px;'>Close</span>",invite_words:"Hello, this is Jin Qiao online customer service. It is our honor to serve you.",other_dept:"Other",invite_word:"Hi,{0} is serving you now! "};JQKF.lang["ms"]={"id":3,list_title:"Online Ask Me",invite_title:"Online Ask Me",btn_accept:"<span style='padding: 5px 0 0 0px;'>Talk Now</span>",btn_refuse:"<span style='padding: 5px 0 0 0px;'>Close</span>",invite_words:"Hello, this is Jin Qiao online customer service. It is our honor to serve you.",other_dept:"Other",invite_word:"Hi,{0} is serving you now! "};JQKF.con.ST_OFFLINE=0;JQKF.con.ST_ONLINE=1;JQKF.con.ST_REQING=2;JQKF.con.ST_TALK=3;JQKF.con.ST_BUSY=5;JQKF.con.open_win_w=670;JQKF.con.open_win_h=496;JQKF.con.UPDATE_STATE_SPAN=10000;JQKF.con.itop=5,JQKF.con.ileft=0,JQKF.con.iright=0,JQKF.con.ibottom=5;JQKF.cls.Banner=function(b){if(typeof(b)!=="string"){throw new Error("JQKF.cls.Banner call failed, the parameter("+b+")'s type is not string!")};this._id="JQKFE";this._id_pre=this._id+"_";window[this._id]=this;this._uiCreated=false;this._kfclient=JQKF.obj.KFClient;this._css_fixed=true;this.kfIDs=jqkf_req.clis;this.userID=jqkf_req.xkey;this.mode=jqkf_req.mode;this.anchor=jqkf_req.pos;this.ipos=jqkf_req.ipos;this.listStyle=jqkf_req.ls;this.fixed=!jqkf_req.float==1;this.autoInvited=jqkf_req.invite==1;this.csDept=jqkf_req.dps;this.csPerson=jqkf_req.sivs;this.panelInfo=jqkf_req.site;this.panelHTML=this.panelInfo.tmpl;this.invite_welcome_words=JQKF.util.decodeHTML(this.panelInfo.invite_welcome);this.path_btn_online=this.panelInfo.path_btn_online;this.path_btn_offline=this.panelInfo.path_btn_offline;this.path_invite_back=this.panelInfo.path_invite_back;this.path_list_header=this.panelInfo.path_list_header;this.path_list_middle=this.panelInfo.path_list_middle;this.path_list_bottom=this.panelInfo.path_list_bottom;this.lang=jqkf_req.lang||"zh-cn";this.skin=jqkf_req.skin;this.ext=jqkf_req.ext;this.isec=jqkf_req.isec||JQKF.util.getParam(jqkf_req.ext,"isec");this.debug=jqkf_req.debug;this.elListBox=null;this.elInviteBox=null;this.timer=null;this.timerInvite=null;this.kfInvite=null;this.langLib=null;this.isopen=false};JQKF.cls.Banner._counter=0;JQKF.cls.Banner.getInstance=function(){if(!JQKF.cls.Banner.prototype.instance){JQKF.cls.Banner.prototype.instance=new JQKF.cls.Banner((JQKF.cls.Banner._counter++).toString())};return JQKF.cls.Banner.prototype.instance};JQKF.cls.Banner.prototype={init:function(){if(this.mode==3&&!this.autoInvited)return;if(jQuery.browser.msie)this._css_fixed=false;this.langLib=JQKF.lang[this.lang];this.csPerson.sort(function(b,c){return-(b["sort"]-c["sort"])});this.initPanelHTML()},initPanelHTML:function(){if(this._uiCreated)return;var b=this;this.elInviteBox=JQKF.util.g(this._id+"_invite_container");if(this.elInviteBox.parentNode!=document.body){document.body.appendChild(this.elInviteBox);if(!this.fixed){document.body.appendChild(document.getElementById(this._id+"_list_container"));document.body.appendChild(document.getElementById(this._id+"_pic_container"))}};if(this.skin=="default"||!this.skin)this.skin="0";if(this.mode!=3){if(this.mode==0){jQuery("#"+this._id+"_list_container").hide();jQuery("#"+this._id+"_pic_container").show();var c=false;var d=false;var e="l";if(this.path_btn_online&&jqkf_req.vdate==1){var f=this._kfclient.adminHTTP+this.path_btn_online;jQuery(".img_pic_image_online").css("background","url("+f+") no-repeat scroll 0 0 transparent");JQKF.util.getImageWH(f,function(){jQuery(".img_pic_image_online").css("width",this.width+"px").css("height",this.height+"px");jQuery(".div_pic_move").css("width",this.width+"px");if(!c){jQuery(".kf_div_pic_container").css("width",this.width+"px").css("height",this.height+"px");b.setKFListBoxPos();c=true}})}else{if(this.anchor==0||this.anchor==2||this.anchor==4){e="l"}else{e="r"};jQuery(".img_pic_image_online").addClass("img_pic_image_online_"+e+"_"+this.lang);if(!c){var f=jQuery(".img_pic_image_online_"+e+"_"+this.lang).css("width");var g=jQuery(".img_pic_image_online_"+e+"_"+this.lang).css("height");jQuery(".kf_div_pic_container").css("width",f).css("height",g);jQuery(".div_pic_move").css("width",f);d=true}};if(this.path_btn_offline&&jqkf_req.vdate==1){var f=this._kfclient.adminHTTP+this.path_btn_offline;jQuery(".img_pic_image_offline").css("background","url("+f+") no-repeat scroll 0 0 transparent");JQKF.util.getImageWH(f,function(){jQuery(".img_pic_image_offline").css("width",this.width+"px").css("height",this.height+"px");jQuery(".div_pic_move").css("width",this.width+"px");if(!c){jQuery(".kf_div_pic_container").css("width",this.width+"px").css("height",this.height+"px");b.setKFListBoxPos();c=true}})}else{if(this.anchor==0||this.anchor==2||this.anchor==4){e="l"}else{e="r"};jQuery(".img_pic_image_offline").addClass("img_pic_image_offline_"+e+"_"+this.lang);if(!d){var f=jQuery(".img_pic_image_offline_"+e+"_"+this.lang).css("width");var g=jQuery(".img_pic_image_offline_"+e+"_"+this.lang).css("height");jQuery(".kf_div_pic_container").css("width",f).css("height",g);jQuery(".div_pic_move").css("width",f);d=true}}}else if(this.mode==1||this.mode==2){jQuery("#"+this._id+"_list_container").show();jQuery("#"+this._id+"_pic_container").hide();if(this.path_list_header&&jqkf_req.vdate==1)jQuery(".div_normal_container").css("background","url("+this._kfclient.adminHTTP+this.path_list_header+") no-repeat scroll 0 0 transparent");if(this.path_list_middle&&jqkf_req.vdate==1)jQuery(".div_list_body").css("background","url("+this._kfclient.adminHTTP+this.path_list_middle+") no-repeat scroll 0 0 transparent");if(this.path_list_bottom&&jqkf_req.vdate==1)jQuery(".div_list_foot").css("background","url("+this._kfclient.adminHTTP+this.path_list_bottom+") no-repeat scroll 0 0 transparent");jQuery("#"+this._id+"_list_title").html(this.panelInfo.list_title||this.langLib["list_title"]);if(this.anchor==0||this.anchor==2||this.anchor==4){jQuery(".div_mini_container").addClass("div_mini_container_l_"+this.lang)}else{jQuery(".div_mini_container").addClass("div_mini_container_r_"+this.lang)}};if(this.path_invite_back&&jqkf_req.vdate==1)jQuery(".kf_div_invite_container").css("background","url("+this._kfclient.adminHTTP+this.path_invite_back+") no-repeat scroll 0 0 transparent");jQuery(".div_list_head").bind("mousedown",this,this.drag_list_mousedown);jQuery(".div_pic_move").bind("mousedown",this,this.drag_list_mousedown);this.showKFList();};jQuery(this.elInviteBox).hide();if(this.invite_welcome_words!="Invited to welcome the concept of temporary"&&this.invite_welcome_words!="")jQuery("#"+this._id+"_invite_words").html(this.invite_welcome_words);else jQuery("#"+this._id+"_invite_words").html(this.langLib["invite_words"]);jQuery("#"+this._id+"_invite_header").html(this.panelInfo.invite_title||this.langLib["invite_title"]);jQuery("#kf_btn_accept").html(this.langLib["btn_accept"]);jQuery("#kf_btn_refuse").html(this.langLib["btn_refuse"]);jQuery("#"+this._id+"_invite_header").bind("mousedown",this,this.drag_mousedown);this.showInviteBox(false);if(this.isec&&!isNaN(this.isec)&&this.isec>0){if(this.autoInvited)this.timerInvite=setInterval(function(){if(b.isopen)clearInterval(b.timerInvite);else b.showInviteBox(true)},this.isec*1000);else this.timerInvite=setTimeout(function(){if(b.isopen)clearInterval(b.timerInvite);else b.showInviteBox(true)},this.isec*1000)};setTimeout(function(){b.updateKFState()},JQKF.con.UPDATE_STATE_SPAN);this._uiCreated=true;return true},drag_mousedown:function(b){var c=b.data;c.elInviteBox.startX=b.clientX;c.elInviteBox.startY=b.clientY;c.elInviteBox.startT=parseInt(c.elInviteBox.style.top);c.elInviteBox.startL=parseInt(c.elInviteBox.style.left);jQuery(document.body).bind("mousemove",c,c.drag_mousemove);jQuery(document.body).bind("mouseup",c,c.drag_mouseup)},drag_mousemove:function(b){var c=b.data;c.elInviteBox.style.left=(c.elInviteBox.startL+(b.clientX-c.elInviteBox.startX))+"px";c.elInviteBox.style.top=(c.elInviteBox.startT+(b.clientY-c.elInviteBox.startY))+"px"},drag_mouseup:function(b){var c=b.data;jQuery(document.body).unbind("mousemove",c.drag_mousemove);jQuery(document.body).unbind("mouseup",c.drag_mouseup)},drag_list_mousedown:function(b){var c=b.data;c.elListBox.startX=b.clientX;c.elListBox.startY=b.clientY;c.elListBox.startT=parseInt(c.elListBox.style.top);c.elListBox.startL=parseInt(c.elListBox.style.left||(jQuery(window).width()-jQuery(c.elListBox).width()-JQKF.con.iright));jQuery(document.body).bind("mousemove",c,c.drag_list_mousemove);jQuery(document.body).bind("mouseup",c,c.drag_list_mouseup)},drag_list_mousemove:function(b){var c=b.data;c.elListBox.style.left=(c.elListBox.startL+(b.clientX-c.elListBox.startX))+"px";c.elListBox.style.top=(c.elListBox.startT+(b.clientY-c.elListBox.startY))+"px"},drag_list_mouseup:function(b){var c=b.data;jQuery(document.body).unbind("mousemove",c.drag_list_mousemove);jQuery(document.body).unbind("mouseup",c.drag_list_mouseup)},showKFList:function(){JQKF.util.g(this._id_pre+"list_content").innerHTML="";switch(this.mode){case 0:this.elListBox=JQKF.util.g(this._id+"_pic_container");break;case 1:this.createDeptListHTML();this.elListBox=JQKF.util.g(this._id+"_list_container");break;case 2:this.createDeptListHTML();this.createKfListHTML();this.hideNoKFDept();this.elListBox=JQKF.util.g(this._id+"_list_container");break;case 3:this.elListBox=JQKF.util.g(this._id+"_list_container");jQuery(this.elListBox).hide();return};this.setKFListBoxPos();this.setKFState();if(this.elListBox==null)return false;if(this.mode==1||this.mode==2){switch(this.listStyle){case 0:break;case 1:this.onClick_BannerClose();break;case 2:jQuery(".div_list_close").hide();break}};this.elListBox.style.display="block"},createDeptListHTML:function(){if(!this.csDept||this.csDept.length==0)return;var b=[];switch(this.mode){case 1:var c=this;JQKF.util.forEach(this.csDept,function(e,f){b.push("<div id=\"",c._id,"_list_dept_",e.did,"\" class=\"div_list_dept_container\">");b.push("<div class=\"div_list_dept\" title=\"\" onclick=\"",c._id,".onClick_OpenDeptChat(",e.did,")\" style=",(e.did==0?"\"display:none;\"":"cursor:pointer;"),">");b.push("<div class=\"div_list_dept_left\"><span></span></div>");b.push("<div class=\"div_list_dept_middle\">",e.name,"</div>");b.push("<div class=\"div_list_dept_right\"><span></span></div>");b.push("</div>");b.push("</div>")});break;case 2:var d=false;if(this.csDept.length==1&&this.csDept[0].did==0)d=true;var c=this;JQKF.util.forEach(this.csDept,function(e,f){b.push("<div id=\"",c._id,"_list_dept_",e.did,"\" class=\"div_list_dept_container\">");b.push("<div class=\"div_list_dept\" title=\"",e.name,"\"",(d?" style=\"display:none;\"":""),">");b.push("<div class=\"div_list_dept_left\"><span class=\"span_list_dept_left\"></span></div>");b.push("<div class=\"div_list_dept_middle\">",e.did==0?c.langLib["other_dept"]:e.name,"</div>");b.push("<div class=\"div_list_dept_right\"><span class=\"span_list_dept_right\"></span></div>");b.push("</div>");b.push("</div>")});break};jQuery("#"+this._id+"_list_content").append(b.join(""))},createKfListHTML:function(){var b=this;JQKF.util.forEach(this.csPerson,function(c,d){if(!b.kfIDs||JQKF.util.contains(b.kfIDs,c.id)){var e=[];var f=JQKF.util.g(b._id_pre+"list_dept_"+c.did);if(f==null)f=JQKF.util.g(b._id_pre+"list_dept_0");if(f){e.push("<div id=\"",b._id,"_list_kf_",c.id,"\" class=\"div_list_kf\" title=\"",c.name,"\" onclick=\"",b._id,".onClick_OpenChat('",c.id,"')\" state=\"",c.state,"\">");e.push("    <div class=\"div_list_kf_left\"><span></span></div>");e.push("    <div class=\"div_list_kf_middle\">",c.name||c.id,"</div>");e.push("    <div class=\"div_list_kf_right\"><span></span></div>");e.push("</div>");jQuery(f).append(e.join(""))}}});if(JQKF.util.g(b._id_pre+"list_dept_0")!=null){jQuery("#"+b._id_pre+"list_dept_0 .div_list_kf").css("padding-left","0px");jQuery("#"+b._id_pre+"list_dept_0 .div_list_kf_middle").css("width","71px")}},hideNoKFDept:function(){var b=this;JQKF.util.forEach(this.csDept,function(c,d){var e=JQKF.util.g(b._id+"_list_dept_"+c.did);if(e&&jQuery(e).children().length==1)jQuery(e).hide()})},setKFListBoxPos:function(){if(this.mode==3)return;if(this.elListBox==null)return false;if(this.fixed){this.elListBox.style.position="static";return};if(this._css_fixed)this.elListBox.style.position="fixed";else{this.elListBox.style.position="absolute";var b=this;jQuery(window).bind("scroll",function(){b._setKFListBoxPos(b._css_fixed)})};this._setKFListBoxPos(this._css_fixed)},_setKFListBoxPos:function(b){switch(this.anchor){case 0:this.elListBox.style.left=JQKF.con.ileft+"px";if(b)this.elListBox.style.top=JQKF.con.itop+"px";else this.elListBox.style.top=((document.documentElement.scrollTop||document.body.scrollTop)+JQKF.con.itop)+"px";break;case 1:if(b){this.elListBox.style.right=JQKF.con.iright+"px";this.elListBox.style.top=JQKF.con.itop+"px"}else{this.elListBox.style.left=(jQuery(window).width()-jQuery(this.elListBox).width()||this.elListBox.clientWidth-JQKF.con.iright)+"px";this.elListBox.style.top=((document.body.scrollTop||document.documentElement.scrollTop)+JQKF.con.itop)+"px"};break;case 2:this.elListBox.style.left=JQKF.con.ileft+"px";if(b)this.elListBox.style.top=Math.max(0,(jQuery(window).height()-jQuery(this.elListBox).height()||this.elListBox.clientHeight)/2)+"px";else this.elListBox.style.top=((document.body.scrollTop||document.documentElement.scrollTop)+Math.max(0,(jQuery(window).height()-jQuery(this.elListBox).height()||this.elListBox.clientHeight)/2))+"px";break;case 3:if(b){this.elListBox.style.right=JQKF.con.iright+"px";this.elListBox.style.top=Math.max(0,(jQuery(window).height()-jQuery(this.elListBox).height()||this.elListBox.clientHeight)/2)+"px"}else{this.elListBox.style.left=(jQuery(window).width()-jQuery(this.elListBox).width()||this.elListBox.clientWidth-JQKF.con.iright)+"px";this.elListBox.style.top=((document.body.scrollTop||document.documentElement.scrollTop)+Math.max(0,(jQuery(window).height()-jQuery(this.elListBox).height()||this.elListBox.clientHeight)/2))+"px"};break;case 4:this.elListBox.style.left=JQKF.con.ileft+"px";if(b)this.elListBox.style.bottom=JQKF.con.ibottom+"px";else this.elListBox.style.top=((document.body.scrollTop||document.documentElement.scrollTop)+(jQuery(window).height()-jQuery(this.elListBox).height()||this.elListBox.clientHeight-JQKF.con.ibottom))+"px";break;case 5:if(b){this.elListBox.style.right=JQKF.con.iright+"px";this.elListBox.style.bottom=JQKF.con.ibottom+"px"}else{this.elListBox.style.left=(jQuery(window).width()-jQuery(this.elListBox).width()||this.elListBox.clientWidth-JQKF.con.iright)+"px";this.elListBox.style.top=((document.body.scrollTop||document.documentElement.scrollTop)+(jQuery(window).height()-jQuery(this.elListBox).height()||this.elListBox.clientHeight-JQKF.con.ibottom))+"px"};break}},setKFState:function(){if(this.mode==3)return;if(this.elListBox==null)return false;switch(this.mode){case 0:if(this.fixed)jQuery(this.elListBox).find(".img_pic_close").hide();else{if(this.anchor==0||this.anchor==2||this.anchor==4){jQuery(".img_pic_close").addClass("img_pic_close_l")}else{jQuery(".img_pic_close").addClass("img_pic_close_r")};jQuery(this.elListBox).find(".img_pic_close").show()};if(this.isSomeoneOnline()){jQuery(this.elListBox).find(".img_pic_image_offline").hide();jQuery(this.elListBox).find(".img_pic_image_online").css("display","block")}else{jQuery(this.elListBox).find(".img_pic_image_online").hide();jQuery(this.elListBox).find(".img_pic_image_offline").css("display","block")};break;case 1:var b=this;this._updateDeptState();JQKF.util.forEach(this.csDept,function(c,d){b._updateOneState(c.did,c.state,true)});break;case 2:var b=this;JQKF.util.forEach(this.csPerson,function(c,d){if(!b.kfIDs||JQKF.util.contains(b.kfIDs,c.id)){b._updateOneState(c.id,c.state,true)}});break}},_updateKfState:function(b){for(var c in b){for(var d=0,l=this.csPerson.length;d<l;d++){if(this.csPerson[d].id==c){this.csPerson[d].state=b[c];break}}}},_updateDeptState:function(){for(var b=0,l1=this.csDept.length;b<l1;b++){var c=0,d=0,e=0,f=0;for(var g=0,l2=this.csPerson.length;g<l2;g++){if(this.csPerson[g].did==this.csDept[b].did){switch(this.csPerson[g].state){case JQKF.con.ST_ONLINE:c++;break;case JQKF.con.ST_OFFLINE:d++;break;case JQKF.con.ST_REQING:e++;break;case JQKF.con.ST_TALK:f++;break}}};if(c>0)this.csDept[b].state=JQKF.con.ST_ONLINE;else if(c==0&&e==0&&f==0)this.csDept[b].state=JQKF.con.ST_OFFLINE;else this.csDept[b].state=JQKF.con.ST_BUSY}},updateKFState:function(){var b={cmd:10,sid:this._kfclient.corpID,wid:this._kfclient.winID,key:this._kfclient.userID};var c=this;jQuery.ajax({type:"get",dataType:"jsonp",url:this._kfclient.srvHTTP+JQKF.util.jsonToUrl(b)+"&fmt=jsonp&?callback=?",success:function(d){clearInterval(c.timer);var e=d.state;var f=d.invite;var g=d.result;if(g&&g=="login"){c._kfclient.ajaxLogin()};if(e){if(c.mode==0){c._updateKfState(e);c.setKFState()}else if(c.mode==1){c._updateKfState(e);c._updateDeptState();JQKF.util.forEach(c.csDept,function(h,i){c._updateOneState(h.did,h.state,true)})}else{c._updateKfState(e);for(var h in e){c._updateOneState(h,e[h]);}};if(f&&f.cli){var h=JQKF.util.find(c.csPerson,function(i,j){return i.id==f.cli});if(h){JQKF.util.g(c._id+"_invite_words").innerHTML="&nbsp;&nbsp;&nbsp;&nbsp; <b>"+JQKF.util.format(c.langLib["invite_word"],h.name)+"</b>";c.showInviteBox(true);c.kfInvite=h.id}}};c.timer=setTimeout(function(){c.updateKFState()},JQKF.con.UPDATE_STATE_SPAN)},error:function(d,e){clearInterval(c.timer);c.timer=setTimeout(function(){c.updateKFState()},JQKF.con.UPDATE_STATE_SPAN)}});},_updateOneState:function(b,c,d){if(this.mode==0){}else if(this.mode==1){var e=JQKF.util.g(this._id+"_list_dept_"+b);if(e){if(!d&&parseInt(jQuery(e).attr("state"))==c)return;jQuery(e).find(".div_list_dept_left span").removeAttr("class");jQuery(e).find(".div_list_dept_right span").removeAttr("class");switch(c){case JQKF.con.ST_OFFLINE:jQuery(e).find(".div_list_dept_left span").addClass("span_list_dept_left_offline");jQuery(e).find(".div_list_dept_right span").addClass("span_list_dept_right_offline");break;case JQKF.con.ST_ONLINE:jQuery(e).find(".div_list_dept_left span").addClass("span_list_dept_left_online");jQuery(e).find(".div_list_dept_right span").addClass("span_list_dept_right_online");break;default:jQuery(e).find(".div_list_dept_left span").addClass("span_list_dept_left_busy");jQuery(e).find(".div_list_dept_right span").addClass("span_list_dept_right_busy");break};jQuery(e).attr("state",c)}}else{var e=JQKF.util.g(this._id+"_list_kf_"+b);if(e){if(!d&&parseInt(jQuery(e).attr("state"))==c)return;jQuery(e).find(".div_list_kf_left span").removeAttr("class");jQuery(e).find(".div_list_kf_right span").removeAttr("class");switch(c){case JQKF.con.ST_OFFLINE:jQuery(e).find(".div_list_kf_left span").addClass("span_list_kf_left_offline");jQuery(e).find(".div_list_kf_right span").addClass("span_list_kf_right_offline_"+this.lang);break;case JQKF.con.ST_ONLINE:jQuery(e).find(".div_list_kf_left span").addClass("span_list_kf_left_online");jQuery(e).find(".div_list_kf_right span").addClass("span_list_kf_right_online_"+this.lang);break;case JQKF.con.ST_REQING:jQuery(e).find(".div_list_kf_left span").addClass("span_list_kf_left_reqing");jQuery(e).find(".div_list_kf_right span").addClass("span_list_kf_right_reqing_"+this.lang);break;case JQKF.con.ST_TALK:jQuery(e).find(".div_list_kf_left span").addClass("span_list_kf_left_busy");jQuery(e).find(".div_list_kf_right span").addClass("span_list_kf_right_busy_"+this.lang);break};jQuery(e).attr("state",c)}}},showInviteBox:function(b){if(this.elInviteBox.style.display=="block")return;if(!b){if(!this.autoInvited){this.elInviteBox.style.display="none";return}};if(!this.isSomeoneOnline()){this.elInviteBox.style.display="none";return};if(this.ipos==0){var c=Math.max(0,(jQuery(window).width()-jQuery(this.elInviteBox).width())/2);if((this.anchor==0||this.anchor==2||this.anchor==4)&&c<jQuery(this.elListBox).width()){this.elInviteBox.style.left=(jQuery(this.elListBox).width()+5)+"px"}else{this.elInviteBox.style.left=c+"px"};this.elInviteBox.style.top=Math.max(0,(jQuery(window).height()-jQuery(this.elInviteBox).height())/2)+"px";if(this._css_fixed)this.elInviteBox.style.position="fixed";else{this.elInviteBox.style.position="absolute";var d=this;jQuery(window).bind("scroll",function(){d.elInviteBox.style.left=(document.body.scrollLeft||document.documentElement.scrollLeft+Math.max(0,(jQuery(window).width()-jQuery(d.elInviteBox).width())/2))+"px";d.elInviteBox.style.top=((document.body.scrollTop||document.documentElement.scrollTop)+Math.max(0,(jQuery(window).height()-jQuery(d.elInviteBox).height())/2))+"px"})};this.elInviteBox.style.display="block"}else{if(this._css_fixed){var c=jQuery(this.elInviteBox).height();jQuery(this.elInviteBox).css("height","0px");this.elInviteBox.style.position="fixed";this.elInviteBox.style.bottom="0px";this.elInviteBox.style.right="0px";jQuery(this.elInviteBox).animate({height:c+"px"},"slow")}else{var c=this;var d=jQuery(this.elInviteBox).height();jQuery(this.elInviteBox).css("height","0px");this.elInviteBox.style.position="absolute";setTimeout(function(){c.elInviteBox.style.left=Math.max(0,jQuery(window).width()-jQuery(c.elInviteBox).width())+"px";c.elInviteBox.style.top=((document.body.scrollTop||document.documentElement.scrollTop)+jQuery(window).height())+"px";jQuery(c.elInviteBox).animate({height:d+"px",top:((document.body.scrollTop||document.documentElement.scrollTop)+jQuery(window).height()-d)+"px"},"slow",function(){if(document.body.scrollWidth&&document.body.scrollWidth>jQuery(window).width()){jQuery(c.elInviteBox).css("top",(parseInt(jQuery(c.elInviteBox).css("top"))-16)+"px")}})},3000);jQuery(window).bind("scroll",function(){c.elInviteBox.style.top=((document.body.scrollTop||document.documentElement.scrollTop)+Math.max(0,jQuery(window).height()-jQuery(c.elInviteBox).height()))+"px"})}}},isSomeoneOnline:function(){var b=this;return JQKF.util.some(this.csPerson,function(c,d){if(!b.kfIDs||JQKF.util.contains(b.kfIDs,c.id)){if(c.state==JQKF.con.ST_ONLINE)return true};return false})},openChat:function(b){var c=this.skin||"default";var d=this._kfclient.srvHTTP+"skin/"+c+(this.debug=="1"?"/chat_debug.html?":"/chat.html?")+"key="+this._kfclient.userID+"&sid="+this._kfclient.corpID+"&wid="+this._kfclient.winID+"&cid="+b+"&lang="+this.lang+"&visitcount="+this._kfclient.visitCount;window.open(d,"fgsd","width="+JQKF.con.open_win_w+",height="+JQKF.con.open_win_h+",location=no,resizable=1,scrollbars=0,status=no,toolbar=no,menu=no,top=100,left=200");this.isopen=true},openLeave:function(b){b=b||this.kfIDs.split(",")[0];var c="key="+this._kfclient.userID+"&sid="+this._kfclient.corpID+"&wid="+this._kfclient.winID+"&cid="+(b||"")+"&lang="+this.lang;var d=this._kfclient.adminHTTP+"chat_leave.aspx?"+c;window.open(d)},_findOneOnlineChatKf:function(){var b=this;var c=JQKF.util.find(this.csPerson,function(d,e){if(!b.kfIDs||JQKF.util.contains(b.kfIDs,d.id)){if(d.state==JQKF.con.ST_ONLINE)return true};return false});return c},dispose:function(){},onClick_BannerClose:function(){jQuery(".div_normal_container").hide();setTimeout(function(){jQuery(".div_mini_container").show()},(this.anchor==0||this.anchor==2||this.anchor==4)?100:3000)},onOver_BannerShow:function(){jQuery(".div_normal_container").show();jQuery(".div_mini_container").hide()},onClick_PicClose:function(){jQuery(this.elListBox).hide();var b=this;setTimeout(function(){jQuery(b.elListBox).show()},30000)},onClick_OpenChat:function(b){var c=JQKF.util.g(this._id+"_list_kf_"+b);if(c){switch(parseInt(jQuery(c).attr("state"))){case JQKF.con.ST_OFFLINE:this.openLeave(b);break;case JQKF.con.ST_ONLINE:this.openChat(b);break;case JQKF.con.ST_REQING:break;case JQKF.con.ST_TALK:break;case JQKF.con.ST_BUSY:this.openLeave(b);break;default:this.openLeave(b);break};jQuery(this.elInviteBox).hide()}},onClick_OpenPicChat:function(){var b=this._findOneOnlineChatKf();if(b!=null){this.openChat(b.id)}else{this.openLeave()};jQuery(this.elInviteBox).hide()},onClick_OpenPicLeave:function(){this.openLeave()},onClick_OpenDeptChat:function(b){var c=this;var d=JQKF.util.g(this._id+"_list_dept_"+b);if(d){switch(parseInt(jQuery(d).attr("state"))){case JQKF.con.ST_OFFLINE:this.openLeave();break;case JQKF.con.ST_ONLINE:var e=JQKF.util.find(this.csPerson,function(f,g){if(!c.kfIDs||JQKF.util.contains(c.kfIDs,f.id)){if(b==f.did&&f.state==JQKF.con.ST_ONLINE)return true};return false});if(e!=null)this.openChat(e.id);break}}},onClickInviterClose:function(){jQuery(this.elInviteBox).hide()},onClick_InviterAccept:function(){var b;if(this.kfInvite==null){b=this._findOneOnlineChatKf();if(b!=null){this.openChat(b.id)}}else{this.openChat(this.kfInvite)};jQuery(this.elInviteBox).hide();this.kfInvite=null},onClick_InviterLeave:function(){this.openLeave(this.kfInvite)},onClick_InviterOpenCall:function(){},onClick_InviterRefuse:function(){jQuery(this.elInviteBox).hide();this.kfInvite=null}};JQKF.con.UPDATE_STATE_SPAN=10000;JQKF.con.GET_VKEY_TIMES=5;(function(){JQKF.obj.KFClient={srvHTTP:null,corpID:null,winID:null,userID:null,visitCount:1,talkCount:0,banner:null,_inited:false,cookieName:"",lastLoginTime:0,isblock:false,parseParam:function(){jqkf_req.lang=jqkf_req.lang||JQKF.util.getParam(jqkf_req.ext,"lang")||"zh-cn";if(jqkf_req.sid!=0)return;var b=jqkf_req.srv.replace("http://","");b=b.substr(0,b.indexOf("."));if(b=="192")b="3";jqkf_req.sid=parseInt(b);jqkf_req.mode=jqkf_req.mode||parseInt(JQKF.util.getParam(jqkf_req.ext,"mode")||"2");jqkf_req.skin=jqkf_req.skin||parseInt(JQKF.util.getParam(jqkf_req.ext,"skin")||"0");jqkf_req.float=jqkf_req.float||parseInt(JQKF.util.getParam(jqkf_req.ext,"float")||"1");jqkf_req.pos=jqkf_req.pos||parseInt(JQKF.util.getParam(jqkf_req.ext,"pos")||"2");jqkf_req.ipos=jqkf_req.ipos||parseInt(JQKF.util.getParam(jqkf_req.ext,"ipos")||"0");jqkf_req.ls=jqkf_req.ls||parseInt(JQKF.util.getParam(jqkf_req.ext,"ls")||"0");jqkf_req.invite=jqkf_req.invite||parseInt(JQKF.util.getParam(jqkf_req.ext,"invite")||"1");jqkf_req.clis=jqkf_req.clis||JQKF.util.getParam(jqkf_req.ext,"clis")||""},get_guest_id:function(b){var c=this;if(typeof(jqkf_vkey_over)!='undefined'&&jqkf_vkey_over==0&&JQKF.con.GET_VKEY_TIMES>0){JQKF.con.GET_VKEY_TIMES--;setTimeout(function(){c.get_guest_id(b)},500)}else{if(!b&&(typeof(jqkf_guest_id)=='undefined'||!jqkf_guest_id)){var d="http://"+JQKF.util.trim(jqkf_req.cdn)+"/";jQuery.getScript(d+"js/swfobject.js",function(){var e=document.createElement("DIV");e.id="jqkf_gid2_c";document.body.appendChild(e);var f=new SWFObject(d+"jqkf_gid.swf","jqkf_gid2","1","1","9","#FF0066");f.addParam("allowScriptAccess","always");f.addParam("play","true");f.addParam("wmode","transparent");f.write("jqkf_gid2_c");JQKF.con.GET_VKEY_TIMES=5;setTimeout(function(){c.get_guest_id(true)},500)});return};if(typeof(jqkf_guest_id)!='undefined'&&jqkf_guest_id){this.userID="k"+jqkf_req.sid+jqkf_guest_id;if(JQKF.util.contains(jqkf_req.blocks,this.userID))this.isblock=true};this.init()}},init:function(){if(this._inited)return;this.adminHTTP="http://"+JQKF.util.trim(jqkf_req.web)+"/";this.cdnHTTP="http://"+JQKF.util.trim(jqkf_req.cdn)+"/";this.srvHTTP=jqkf_req.srv;this.corpID=jqkf_req.sid;this.winID=jqkf_req.wid;this.cookieName="jqkf"+this.corpID;if(!this.userID){this.userID=jqkf_req.xkey;var c=JQKF.util.getCookie(this.cookieName+"_key");if(c)this.userID=c;else JQKF.util.setCookie(this.cookieName+"_key",this.userID)};if(window["jqkf_vcnt"])this.visitCount=parseInt(window["jqkf_vcnt"]);else{var c=JQKF.util.getCookie(this.cookieName+"_vc");if(c)this.visitCount=parseInt(c)};if(window["jqkf_tcnt"])this.talkCount=parseInt(window["jqkf_tcnt"]);else{var c=JQKF.util.getCookie(this.cookieName+"_tc");if(c)this.talkCount=parseInt(c)};var b=JQKF.util.getCookie(this.cookieName+"_llt");if(b)this.lastLoginTime=parseInt(b);this.ajaxLogin();if(this.isblock)return;if(jqkf_req.mode==3&&jqkf_req.invite==0){var c=this;setInterval(function(){var d={cmd:10,sid:c.corpID,wid:c.winID,key:c.userID};jQuery.getJSON(c.srvHTTP+JQKF.util.jsonToUrl(d)+"?callback=?")},JQKF.con.UPDATE_STATE_SPAN)}else{this.banner=JQKF.cls.Banner.getInstance();this.banner.init()};this._addCloseHook();this._inited=true},ajaxLogin:function(){var b={cmd:2,login:1,sid:this.corpID,wid:this.winID,key:this.userID,cnt:this.visitCount,tcnt:this.talkCount,block:this.isblock?1:0,charset:document.charset||document.characterSet,pagetitle:(window.top||window).document.title,page:escape((window.top||window).location||(window.top||window).document.URL),referer:escape((window.top||window).document.referrer),browser:JQKF.browser.fullName,system:JQKF.platform.fullName,tzone:0-new Date().getTimezoneOffset(),sSize:screen.width+'x'+screen.height,tcolor:screen.colorDepth||screen.pixelDepth,lng:navigator.systemLanguage||navigator.userLanguage||navigator.language.toLowerCase()||jqkf_req.lang||"zh-cn"};jQuery.getJSON(this.srvHTTP+JQKF.util.jsonToUrl(b)+"?callback=?")},_closeWinHook:function(b){var c=b.data;if((new Date().valueOf()-c.lastLoginTime)>3*3600*1000){if(thisFla("jqkf_gid")&&thisFla("jqkf_gid").setVisitCount){thisFla("jqkf_gid").setVisitCount(++c.visitCount)}else{JQKF.util.setCookie(c.cookieName+"_vc",++c.visitCount)};JQKF.util.setCookie(c.cookieName+"_llt",new Date().valueOf())};c.destroy()},_addCloseHook:function(){jQuery(window).bind("beforeunload",this,this._closeWinHook);jQuery(window).bind("unload",function(b){})},destroy:function(){}}})();function JQKF_Start(){JQKF.obj.KFClient.parseParam();var b=document.getElementById("jqkf_gid");if(b!=null&&b.parentNode!=document.body){document.body.appendChild(b)};JQKF.obj.KFClient.get_guest_id(false)};JQKF.util.ready=function(b){var c=JQKF.util.ready;if(c.done){return b()};if(c.timer){c.ready.push(b)}else{var q=function(){if(c.done){return true};if(document&&document.getElementsByTagName&&document.getElementById&&document.body&&typeof(jQuery)!="undefined"&&document.getElementById("jqkf_gid")){c.done=true;window.clearInterval(c.timer);c.timer=null;for(var d=0;d<c.ready.length;d++){c.ready[d]()};c.ready=null;return true}};c.ready=[b];c.timer=window.setInterval(q,1000)}};JQKF.util.ready(JQKF_Start);function thisFla(b){if(navigator.appName.indexOf("Microsoft")!=-1){return window[b]}else{return document[b]}}